import{mkdirSync as e,writeFileSync as n}from"fs";import{join as t,dirname as r}from"path";function a(e){console.log("Illegal argument exception: "+JSON.stringify(e,null,2))}function l(e){console.log(`${e} is undefined`)}var _=Object.freeze({__proto__:null,unexpected:a,propUndefined:l});let i;function p(e){let n=e.in.data;return i=e.proc.data,void 0===n?l("options.in.data"):void 0===i?l("options.proc.data"):y(n)}function o(e){return"ref"!==e.type?a(e):i.ref.replaceAll("_NAME_",e.name)}function u(e){return"val"!==e.type?a(e):i.val.replaceAll("_NAME_",e.expression)}function c(e){if(void 0===e)return a(e);switch(e.type){case"ref":return o(e);case"val":return u(e);default:return a(e)}}function s(e){if("v"!==e.type)return a(e);let n=c(e.expression);return i.v.replaceAll("_NAME_",e.name).replaceAll("_EXPRESSION_",n)}function f(e){if("dec"!==e.type)return a(e);let n=c(e.value);return i.dec.replaceAll("_PROP_",e.prop).replaceAll("_VALUE_",n)}function m(e){return"param"!==e.type?a(e):e.default?i.paramDefault.replaceAll("_NAME_",e.name).replaceAll("_DEFAULT_",e.default):i.param.replaceAll("_NAME_",e.name)}function A(e){let n=[];if(Array.isArray(e))for(let t in e)n.push(m(e[t]));else n.push(m(e));return n.join(i.paramSep)}function d(e){return"arg"!==e.type?a(e):c(e.expression)}function E(e){let n=[];if(Array.isArray(e))for(let t in e)n.push(d(e[t]));else n.push(d(e));return n.join(i.argSep)}function S(e){return"call"!==e.type?a(e):i.call.replace("_NAME_",e.name).replaceAll("_ARGS_",E(e.args))}function M(e){if("mixin"!==e.type)return a(e);let n=i.mixin.replaceAll("_NAME_",e.name).replaceAll("_PARAMS_",A(e.params)).replaceAll("_BODY_",N(e.body));return i.needBrln&&(n+="\n"),n}function N(e){let n=e,t="";for(let e in n){let r,l=n[e];switch(l.type){case"call":r=S(l);break;case"v":r=s(l);break;case"dec":r=f(l);break;case"mixin":r=M(l);break;default:return a(l)}let _=i.statementEnd;e!=n.length-1||i.needLastStatementEnd||(_=""),i.needBrln&&(_+="\n"),t=t+i.indent+r+_}return t}function y(e){let n="";for(let t in e){let r,l=e[t];switch(l.type){case"call":r=S(l);break;case"v":r=s(l);break;case"mixin":r=M(l);break;default:return a(l)}let _=i.statementEnd;(t==e.length-1&&!i.needLastStatementEnd||"mixin"===l.type)&&(_=""),i.needBrln&&"mixin"!==l.type&&(_+="\n"),n=n+r+_}return n}var v=Object.freeze({__proto__:null,default:p,ref:o,val:u,exp:c,v:s,dec:f,param:m,params:A,arg:d,args:E,call:S,mixin:M,body:N,globalStatements:y});function x(a,l){const _=t(l.dirname,l.name+l.extname),i=r(_);e(i,{recursive:!0}),n(_,a)}function g(e,n){const t=n.out.file;!function(e="./dist/",t="concrete",r=n.proc.data.extname){n.out.file.dirname=e,n.out.file.name=t,n.out.file.extname=r}(t.dirname,t.name,t.extname),x(e,t)}var O=Object.freeze({__proto__:null,writeFileResolve:x,default:function(e){x(p(e),e.out.file)},handleWriteFile:g});function R(e){const n=p(e);e.out.print&&console.log(n),e.out.file&&g(n,e)}function P(e){return{type:"arg",expression:e}}function b(e,n){return{type:"param",name:e,default:n}}var L=Object.freeze({__proto__:null,call:function(e,n){return{type:"call",name:e,args:n}},arg:P,dec:function(e,n){return{type:"dec",prop:e,value:n}},v:function(e,n){return{type:"v",name:e,expression:n}},val:function(e){return{type:"val",expression:e}},ref:function(e){return{type:"ref",name:e}},mixin:function(e,n,t){return{type:"mixin",name:e,params:n,body:t}},param:b,args:function(...e){let n=[];for(let t in e){let r=e[t];n.push(P(r))}return n},params:function(...e){let n=[];for(let t in e){let r=e[t],a=r[0],l=r[1];n.push(b(a,l))}return n}}),D=Object.freeze({__proto__:null,less:{extname:".less",wordSep:"-",statementEnd:";",needLastStatementEnd:!0,needBrln:!0,v:"@_NAME_: _EXPRESSION_",dec:"_PROP_: _VALUE_",call:"._NAME_(_ARGS_)",argSep:", ",arg:"",ref:"@_NAME_",val:"_NAME_",indent:"  ",mixin:"._NAME_(_PARAMS_) {\n_BODY_}",param:"@_NAME_",paramDefault:"@_NAME_: _DEFAULT_",paramSep:", "},lessMin:{extname:".less",wordSep:"-",statementEnd:";",needLastStatementEnd:!1,needBrln:!1,v:"@_NAME_:_EXPRESSION_",dec:"_PROP_:_VALUE_",call:"._NAME_(_ARGS_)",argSep:",",arg:"",ref:"@_NAME_",val:"_NAME_",indent:"",mixin:"._NAME_(_PARAMS_){_BODY_}",param:"@_NAME_",paramDefault:"@_NAME_:_DEFAULT_",paramSep:","},scss:{extname:".scss",wordSep:"-",statementEnd:";",needLastStatementEnd:!0,needBrln:!0,v:"$_NAME_: _EXPRESSION_",dec:"_PROP_: _VALUE_",call:"@include _NAME_(_ARGS_)",argSep:", ",arg:"",ref:"$_NAME_",val:"_NAME_",indent:"  ",mixin:"@mixin _NAME_(_PARAMS_) {\n_BODY_}",param:"$_NAME_",paramDefault:"$_NAME_: _DEFAULT_",paramSep:", "},styl:{extname:".styl",wordSep:"-",statementEnd:";",needLastStatementEnd:!0,needBrln:!0,v:"_NAME_ = _EXPRESSION_",dec:"_PROP_: _VALUE_",call:"._NAME_(_ARGS_)",argSep:", ",arg:"",ref:"_NAME_",val:"_NAME_",indent:"  ",mixin:"_NAME_(_PARAMS_) {\n_BODY_}",param:"_NAME_",paramDefault:"_NAME_ = _DEFAULT_",paramSep:", "}});export{L as builder,R as default,D as langs,_ as logger,R as octopo,v as stringify,O as stringifyFile};
