import{mkdirSync as e,writeFileSync as n}from"fs";import{join as t,dirname as r}from"path";function a(){return()=>{}}function _(e){return e}function l(){}function i(e){if(Array.isArray(e))return function(e){let n=[];return e.forEach((e=>{n.push(i(e))})),n}(e);let n=(e=function(e={}){return function(n=a,t=_,r=l,i={}){e.src=n,e.proc=t,e.sink=r,e.meta=i}(e.src,e.proc,e.sink,e.meta),e}(e)).src(),t=e.proc(n,e.meta);return e.sink(t,e.meta)}function u(a,_){_=function(e={}){return function(n="./dest/index.txt"){e.path=n}(e.path),e}(_);let l=function(e){return"object"==typeof e?(e=function(e){return function(n="./dest/",t="index",r="txt"){e.dirname=n,e.name=t,e.extname=r}(e.dirname,e.name,e.extname),e}(meta.path),t(e.dirname,e.name+e.extname)):e}(_.path);const i=r(l);e(i,{recursive:!0}),n(l,a,_.options)}function c(e){return()=>e}function p(e){return e}function o(e){console.log(`${e} is undefined`)}var s=Object.freeze({__proto__:null,unexpected:function(e){console.log("Illegal argument exception: "+JSON.stringify(e,null,2))},propUndefined:o});function f(e){return null==e?o("options"):i({src:c(e.in.data),proc:stringifyProc,sink:p,meta:{grammar:e.proc.grammar,path:e.out.file}})}var d=Object.freeze({__proto__:null,stringify:f,default:f});function m(e){const n=e.out.file;return function(n="./dist/",t="concrete",r=e.proc.grammar.extname){e.out.file.dirname=n,e.out.file.name=t,e.out.file.extname=r}(n.dirname,n.name,n.extname),e}function A(e,n){i({src:c(e),proc:_,sink:u,meta:{path:n.out.file}})}function E(e,n){A(e,m(n))}function x(e){E(f(e),e)}var M=Object.freeze({__proto__:null,vesicMkfile:A,handleWriteFile:E,stringifyFile:x,default:x});function S(e){const n=f(e);e.out.print&&console.log(n),e.out.file&&E(n,e)}function N(e){return{type:"arg",expression:e}}function g(e,n){return{type:"param",name:e,default:n}}var y=Object.freeze({__proto__:null,_call:function(e,n){return{type:"call",name:e,args:n}},_arg:N,_dec:function(e,n){return{type:"dec",prop:e,value:n}},_var:function(e,n){return{type:"v",name:e,expression:n}},_val:function(e){return{type:"val",expression:e}},_ref:function(e){return{type:"ref",name:e}},_mixin:function(e,n,t){return{type:"mixin",name:e,params:n,body:t}},_param:g,_args:function(...e){let n=[];for(let t in e){let r=e[t];n.push(N(r))}return n},_params:function(...e){let n=[];for(let t in e){let r=e[t],a=r[0],_=r[1];n.push(g(a,_))}return n}});function v(e,n=data){return"ref"!==e.type?unexpected(e):n.ref.replaceAll("_NAME_",e.name)}function P(e,n=data){return"val"!==e.type?unexpected(e):n.val.replaceAll("_NAME_",e.expression)}function O(e,n=data){if(void 0===e)return unexpected(e);switch(e.type){case"ref":return v(e,n);case"val":return P(e,n);default:return unexpected(e)}}function R(e,n=data){if("v"!==e.type)return unexpected(e);let t=O(e.expression,n);return n.var.replaceAll("_NAME_",e.name).replaceAll("_EXPRESSION_",t)}function $(e,n=data){if("dec"!==e.type)return unexpected(e);let t=O(e.value,n);return n.dec.replaceAll("_PROP_",e.prop).replaceAll("_VALUE_",t)}function h(e,n=data){return"param"!==e.type?unexpected(e):e.default?n.paramDefault.replaceAll("_NAME_",e.name).replaceAll("_DEFAULT_",e.default):n.param.replaceAll("_NAME_",e.name)}function L(e,n=data){let t=[];if(Array.isArray(e))for(let r in e)t.push(h(e[r],n));else t.push(h(e,n));return t.join(n.paramSep)}function b(e,n=data){return"arg"!==e.type?unexpected(e):O(e.expression,n)}function D(e,n=data){let t=[];if(Array.isArray(e))for(let r in e)t.push(b(e[r],n));else t.push(b(e,n));return t.join(n.argSep)}function U(e,n=data){return"call"!==e.type?unexpected(e):n.call.replace("_NAME_",e.name).replaceAll("_ARGS_",D(e.args,n))}function B(e,n=data){if("mixin"!==e.type)return unexpected(e);let t=n.mixin.replaceAll("_NAME_",e.name).replaceAll("_PARAMS_",L(e.params,n)).replaceAll("_BODY_",k(e.body,n));return n.needBrln&&(t+="\n"),t}function k(e,n=data){let t=e,r="";for(let e in t){let a,_=t[e];switch(_.type){case"call":a=U(_,n);break;case"v":a=R(_,n);break;case"dec":a=$(_,n);break;case"mixin":a=B(_,n);break;default:return unexpected(_)}let l=n.statementEnd;e!=t.length-1||n.needLastStatementEnd||(l=""),n.needBrln&&(l+="\n"),r=r+n.indent+a+l}return r}function F(e,n=data){if(void 0===e)return propUndefined("ast");if(void 0===n)return propUndefined("lang");let t="";for(let r in e){let a,_=e[r];switch(_.type){case"call":a=U(_,n);break;case"v":a=R(_,n);break;case"mixin":a=B(_,n);break;default:return unexpected(_)}let l=n.statementEnd;(r==e.length-1&&!n.needLastStatementEnd||"mixin"===_.type)&&(l=""),n.needBrln&&"mixin"!==_.type&&(l+="\n"),t=t+a+l}return t}var j=Object.freeze({__proto__:null,$ref:v,$val:P,$exp:O,$var:R,$dec:$,$param:h,$params:L,$arg:b,$args:D,$call:U,$mixin:B,$body:k,$globalStatements:F}),w=Object.freeze({__proto__:null,less:{var:"@_NAME_: _EXPRESSION_",mixin:"._NAME_(_PARAMS_) {\n_BODY_}",dec:"_PROP_: _VALUE_",param:"@_NAME_",paramDefault:"@_NAME_: _DEFAULT_",call:"._NAME_(_ARGS_)",ref:"@_NAME_",val:"_NAME_",arg:"",argSep:", ",paramSep:", ",statementEnd:";",needLastStatementEnd:!0,indent:"  ",needBrln:!0,wordSep:"-",extname:".less"},lessMin:{var:"@_NAME_:_EXPRESSION_",mixin:"._NAME_(_PARAMS_){_BODY_}",dec:"_PROP_:_VALUE_",param:"@_NAME_",paramDefault:"@_NAME_:_DEFAULT_",call:"._NAME_(_ARGS_)",ref:"@_NAME_",val:"_NAME_",arg:"",argSep:",",paramSep:",",statementEnd:";",needLastStatementEnd:!1,indent:"",needBrln:!1,wordSep:"-",extname:".less"},scss:{var:"$_NAME_: _EXPRESSION_",mixin:"@mixin _NAME_(_PARAMS_) {\n_BODY_}",dec:"_PROP_: _VALUE_",param:"$_NAME_",paramDefault:"$_NAME_: _DEFAULT_",call:"@include _NAME_(_ARGS_)",ref:"$_NAME_",val:"_NAME_",arg:"",argSep:", ",paramSep:", ",statementEnd:";",needLastStatementEnd:!0,indent:"  ",needBrln:!0,wordSep:"-",extname:".scss"},scssMin:{var:"$_NAME_:_EXPRESSION_",mixin:"@mixin _NAME_(_PARAMS_){_BODY_}",dec:"_PROP_:_VALUE_",param:"$_NAME_",paramDefault:"$_NAME_:_DEFAULT_",call:"@include _NAME_(_ARGS_)",ref:"$_NAME_",val:"_NAME_",arg:"",argSep:",",paramSep:",",statementEnd:";",needLastStatementEnd:!1,indent:"",needBrln:!1,wordSep:"-",extname:".scss"},styl:{var:"_NAME_ = _EXPRESSION_",mixin:"_NAME_(_PARAMS_) {\n_BODY_}",dec:"_PROP_: _VALUE_",param:"_NAME_",paramDefault:"_NAME_ = _DEFAULT_",call:"._NAME_(_ARGS_)",ref:"_NAME_",val:"_NAME_",arg:"",argSep:", ",paramSep:", ",statementEnd:";",needLastStatementEnd:!0,indent:"  ",needBrln:!0,wordSep:"-",extname:".styl"}});function I(e,n){return F(e,n.grammar)}var z={outFile:m};export{S as default,y as factory,w as langs,s as logger,S as octopo,z as options,j as stringifier,d as stringify,M as stringifyFile,I as stringifyProc};
