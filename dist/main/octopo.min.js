import{mkdirSync as e,writeFileSync as n}from"fs";import{join as t,dirname as r}from"path";function a(e){console.log("Illegal argument exception: "+JSON.stringify(e,null,2))}function l(e){console.log(`${e} is undefined`)}var _=Object.freeze({__proto__:null,unexpected:a,propUndefined:l});let i;function u(e){if(null==e)return l("options");let n=e.in.data;return i=e.proc.grammar,y(n,i)}function p(e,n=i){return"ref"!==e.type?a(e):n.ref.replaceAll("_NAME_",e.name)}function o(e,n=i){return"val"!==e.type?a(e):n.val.replaceAll("_NAME_",e.expression)}function c(e,n=i){if(void 0===e)return a(e);switch(e.type){case"ref":return p(e,n);case"val":return o(e,n);default:return a(e)}}function s(e,n=i){if("v"!==e.type)return a(e);let t=c(e.expression,n);return n.var.replaceAll("_NAME_",e.name).replaceAll("_EXPRESSION_",t)}function f(e,n=i){if("dec"!==e.type)return a(e);let t=c(e.value,n);return n.dec.replaceAll("_PROP_",e.prop).replaceAll("_VALUE_",t)}function m(e,n=i){return"param"!==e.type?a(e):e.default?n.paramDefault.replaceAll("_NAME_",e.name).replaceAll("_DEFAULT_",e.default):n.param.replaceAll("_NAME_",e.name)}function A(e,n=i){let t=[];if(Array.isArray(e))for(let r in e)t.push(m(e[r],n));else t.push(m(e,n));return t.join(n.paramSep)}function d(e,n=i){return"arg"!==e.type?a(e):c(e.expression,n)}function E(e,n=i){let t=[];if(Array.isArray(e))for(let r in e)t.push(d(e[r],n));else t.push(d(e,n));return t.join(n.argSep)}function S(e,n=i){return"call"!==e.type?a(e):n.call.replace("_NAME_",e.name).replaceAll("_ARGS_",E(e.args,n))}function M(e,n=i){if("mixin"!==e.type)return a(e);let t=n.mixin.replaceAll("_NAME_",e.name).replaceAll("_PARAMS_",A(e.params,n)).replaceAll("_BODY_",N(e.body,n));return n.needBrln&&(t+="\n"),t}function N(e,n=i){let t=e,r="";for(let e in t){let l,_=t[e];switch(_.type){case"call":l=S(_,n);break;case"v":l=s(_,n);break;case"dec":l=f(_,n);break;case"mixin":l=M(_,n);break;default:return a(_)}let i=n.statementEnd;e!=t.length-1||n.needLastStatementEnd||(i=""),n.needBrln&&(i+="\n"),r=r+n.indent+l+i}return r}function y(e,n=i){if(void 0===e)return l("ast");if(void 0===n)return l("lang");let t="";for(let r in e){let l,_=e[r];switch(_.type){case"call":l=S(_,n);break;case"v":l=s(_,n);break;case"mixin":l=M(_,n);break;default:return a(_)}let i=n.statementEnd;(r==e.length-1&&!n.needLastStatementEnd||"mixin"===_.type)&&(i=""),n.needBrln&&"mixin"!==_.type&&(i+="\n"),t=t+l+i}return t}var g=Object.freeze({__proto__:null,stringify:u,default:u,$ref:p,$val:o,$exp:c,$var:s,$dec:f,$param:m,$params:A,$arg:d,$args:E,$call:S,$mixin:M,$body:N,$globalStatements:y});function v(e){const n=e.out.file;return function(n="./dist/",t="concrete",r=e.proc.grammar.extname){e.out.file.dirname=n,e.out.file.name=t,e.out.file.extname=r}(n.dirname,n.name,n.extname),e}function x(e){O(u(e),e.out.file)}function O(a,l){const _=t(l.dirname,l.name+l.extname),i=r(_);e(i,{recursive:!0}),n(_,a)}function R(e,n){O(e,(n=v(n)).out.file)}var P=Object.freeze({__proto__:null,stringifyFile:x,default:x,writeFileResolve:O,handleWriteFile:R});function $(e){const n=u(e);e.out.print&&console.log(n),e.out.file&&R(n,e)}function b(e){return{type:"arg",expression:e}}function L(e,n){return{type:"param",name:e,default:n}}var D=Object.freeze({__proto__:null,_call:function(e,n){return{type:"call",name:e,args:n}},_arg:b,_dec:function(e,n){return{type:"dec",prop:e,value:n}},_var:function(e,n){return{type:"v",name:e,expression:n}},_val:function(e){return{type:"val",expression:e}},_ref:function(e){return{type:"ref",name:e}},_mixin:function(e,n,t){return{type:"mixin",name:e,params:n,body:t}},_param:L,_args:function(...e){let n=[];for(let t in e){let r=e[t];n.push(b(r))}return n},_params:function(...e){let n=[];for(let t in e){let r=e[t],a=r[0],l=r[1];n.push(L(a,l))}return n}}),h=Object.freeze({__proto__:null,less:{var:"@_NAME_: _EXPRESSION_",mixin:"._NAME_(_PARAMS_) {\n_BODY_}",dec:"_PROP_: _VALUE_",param:"@_NAME_",paramDefault:"@_NAME_: _DEFAULT_",call:"._NAME_(_ARGS_)",ref:"@_NAME_",val:"_NAME_",arg:"",argSep:", ",paramSep:", ",statementEnd:";",needLastStatementEnd:!0,indent:"  ",needBrln:!0,wordSep:"-",extname:".less"},lessMin:{var:"@_NAME_:_EXPRESSION_",mixin:"._NAME_(_PARAMS_){_BODY_}",dec:"_PROP_:_VALUE_",param:"@_NAME_",paramDefault:"@_NAME_:_DEFAULT_",call:"._NAME_(_ARGS_)",ref:"@_NAME_",val:"_NAME_",arg:"",argSep:",",paramSep:",",statementEnd:";",needLastStatementEnd:!1,indent:"",needBrln:!1,wordSep:"-",extname:".less"},scss:{var:"$_NAME_: _EXPRESSION_",mixin:"@mixin _NAME_(_PARAMS_) {\n_BODY_}",dec:"_PROP_: _VALUE_",param:"$_NAME_",paramDefault:"$_NAME_: _DEFAULT_",call:"@include _NAME_(_ARGS_)",ref:"$_NAME_",val:"_NAME_",arg:"",argSep:", ",paramSep:", ",statementEnd:";",needLastStatementEnd:!0,indent:"  ",needBrln:!0,wordSep:"-",extname:".scss"},styl:{var:"_NAME_ = _EXPRESSION_",mixin:"_NAME_(_PARAMS_) {\n_BODY_}",dec:"_PROP_: _VALUE_",param:"_NAME_",paramDefault:"_NAME_ = _DEFAULT_",call:"._NAME_(_ARGS_)",ref:"_NAME_",val:"_NAME_",arg:"",argSep:", ",paramSep:", ",statementEnd:";",needLastStatementEnd:!0,indent:"  ",needBrln:!0,wordSep:"-",extname:".styl"}});const B={outFile:v};export{$ as default,D as factory,h as langs,_ as logger,$ as octopo,B as options,g as stringify,P as stringifyFile};
